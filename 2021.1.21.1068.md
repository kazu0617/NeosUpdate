**2021.1.21.1068**
原文はこちら: https://discord.com/channels/402159838827905024/469131434628612116/801872790289776711
最近ビルドが少なくて申し訳ありません。開発スピードを上げるための良い方法を見つけようとしていますが、特にデスクトップモードにおいては、デザイン作業の段階でまだコード化されていない内容がたくさんあります。最近はクラウド上にもトラブルがあり、根本的な原因を見つけるのに時間がかかっていましたが、今ではスムーズに動作し、より堅牢になっているので、同じことが二度と起こらないようになっており、またもし将来的に障害が発生した際にであっても調査することのできる新しいツールを導入しました。

今回のビルドでは、シェーダシステムに大きな変更がありました。これにより、私の側では配布や読み込みに独自のシステムを使用するのではなく、アセットバリアントシステムに完全に移行したことで多くのことが単純化されました。これは、シェーダのアップデートを公開する際に、面倒な手動作業の多くを取り除くことができるため、シェーダの追加要求の山を処理する準備として行われました。これは、システムをより効率的に（データをローカル上にキャッシュを行う等）し、大量のバグも排除できます。中には、一般的なアセットのダウンロード/ロードに関連しています。

他にもいくつか追加点があります。外部リンク経由でインベントリフォルダを簡単に共有できるようになりました。Neosでインベントリリンクを取得し、コンテキストメニューを開いて「リンクをコピー」をクリックし、任意の場所に貼り付けるだけです。コピーしてNeosに貼り付けると、インベントリリンクの項目がポップアップ表示されます。

このビルドのうち一部は、様々な機能をもたらすための基盤を整えている段階です。引き続き乞うご期待を！
**新機能(New Features)**:
- シェーダアセット(Shader Assets) について、特化したバージョンを使用するのではなく、一般的なアセットバリアントシステムに完全に移行しました。
-- シェーダアセットが通常のアセットから直接ロードされるようになりました (特別なキーワード URL の代わりに neosdb:// から読み込まれるようになりました)。
-- シェーダのメタデータは毎回取得するのではなく、ローカルにキャッシュされるようになりました。負荷時間と帯域幅の使用量が削減されました。
-- バリアントは他のアセットと同じ経路でダウンロードされます。また、より高速なダウンロードのためにCDNを使用することができます。
-- 手動での更新とアップロードプロセスの大部分がなくなり、シェーダーの更新や新機能の追加が簡単になりました。
-- コンパイルされたばかりのシェーダの特定のバリアントを最初にリクエストした人は、いくつかのシェーダのロードに少し時間がかかるかもしれないことに注意してください(通常は1分以内)。
- `MaterialAssetMetadata` を `Assets/Utility` の下に追加しました。
-- この情報はデフォルトでインスペクタにも表示されるようになりました。
- `DefaultAudioDeviceIndex` を `AudioSettingSync` に追加しました。これは、デフォルトのオーディオデバイスを制御するためです。
- `Copy Link` コンテキストメニューオプション を `InventoryLinks` に追加しました。これは URL をクリップボードにコピーして Neos の外で共有できるようにするものです(GearBell さんからのリクエストと chemicalcrux さんからの提案によりものです)。
- オブジェクトやディレクトリ (インベントリリンク) を表す URL について、 `neosrec://` をNeosに貼り付けるだけでインポートできるようになりました。
**最適化(Optimizations)**:
- Android ビルドでは、クラウド上で計算されていない場合、オリジナルのアセットをダウンロードしてメタデータをローカルで計算しようとすることはなくなり、代わりにクラウドの計算が終了するのを待つようになりました。
-- これにより、モバイルでのCPU、メモリ、帯域幅の使用量が大幅に削減されます。
- アセットのロード要求がバックグラウンドスレッドから行われるようになり、これにより静的アセットをロードする際の潜在的な不具合やフレームレートの低下を軽減しました。

**微調整(Tweaks)**:
- 未読メッセージを取得する際の無効なクラウドAPIの利用パターンからの保護を追加しました。以前はこの影響で深刻なデータベース負荷とクラウドサービスのパフォーマンス低下を引き起こしていました。
- NATパンチスルーサービスのセッションNATパンチスルー情報が2つのリモートアドレス間で急速に反転することに対する保護機能を追加しました。
-- あなたやヘッドレスに接続されている人に問題がある場合は、ネットワークを確認してください。セッションは単一のIPとポートの組み合わせからのみアクセス可能である必要があり、複数のセッションに同じカスタムセッションIDを使用することはできません。
- クォータを超えてしまったアカウントやアイテムを削除してしまったアカウントのストレージ容量の使用量を修復するための内部メカニズムを追加しました(もしあなたのクラウド使用量に問題がある場合は、チームメンバー(理想的にはShifty さん)にこの修復の実行を依頼することができます)
- クラウドサービスの問題を診断するために、APIの使用量とデータベースの負荷を相関させるための内部診断機能を追加しました。
- アセットバリアント処理システムにアセットのキャッシングを追加し、アセットメタデータと複数のバリアントの計算に必要な帯域幅の使用量と時間を削減しました。
-- シェーダバリアントのようなアセットファイルがはるかに大きいのに、個々の小さなバリアントがたくさんある場合に特に便利です。
- センサーが正常に動作していない場合に、ヘッドセットの"ヘッドセットの中にいる"ことを示すセンサー信号の変更にタイムアウト（15秒）を追加し、"離席中"から"オンライン"へ頻繁に切り替わることを防止するようになりました（Coffeeさんのレポートを参考にしています。
-- これは、ユーザーがヘッドセットの中にいることを優先するように設定されています。急速なフリップの場合、Neos はユーザーが常にヘッドセットの中にいるように報告します。これは、ヘッドセットを頭に装着しているときに誤動作が発生した際、この影響でNeos内での反応を阻害しないようにするためにも行われます。
- オーディオデバイス選択ダイアログがより一般的になりました
-- マイクに特化したラベルではなく、より一般的なラベルに更新しました。
-- 選択されたオーディオデバイスを直接設定するのではなく、`SelectedDeviceIndex` プロパティを使ってエクスポートするようになりました。
- `XiexeToonMaterial` の `AlphaClip` プロパティについて、デフォルトで0.5から始まるようになりました（chemicalcrux さんの提案に基づきます）。
- 旧式の `DefaultAudioInputDeviceSelector` を削除しました。

- Nammi さんによるアイスランド語ロケールの翻訳追加、更新について統合しました(統合の際に競合していた点は かず が解決しました)。
- Melnus さんによる日本語、エスペラント語、中国語の翻訳追加について統合しました。
- LUA さんによる韓国語の翻訳追加と修正を統合しました。
- Ruzert さんによるスペイン語の翻訳調整を統合しました。
- rampa_3 さんによるチェコ語の翻訳追加を統合しました。
- Shadow Panther さんによるロシア語の翻訳追加を統合しました。
**バグ修正(Bugfixes)**:
- 本来よりも数桁高いスループットを必要とする程クラウドサービスが劣化するといった、データベースクエリーの病理的なケースを修正
- 負荷が高い場合にクラウドAPIが429（リクエストが多すぎる）ではなく500（内部サーバーエラー）で応答していたのを修正
- BAN対象のユーザーがまだログインしている場合にBANがすぐに有効にならない問題を修正
- サポートされていないスキームのGather Jobによって他のGather Jobが詰みあがった所から処理されず、結果として起動できなくなる問題を修正
- 静的アセットの収集に失敗した場合、収集したアセットが不完全なファイルや空のファイルを使用してしまうことがあった問題を修正
-- これは、アセットが破損していたり（ビデオファイルが部分的にしか読み込まれていなかったり）、まったく読み込まれなかったり（シェーダーやメッシュなど）する場合があるのを修正します。
- アセットとそのバリアントをロードする際にファイルサイズが0になっているかの確認を追加し、もし破損している場合はアセットを再収集するようにしました。
- シェーダのバリアントをロードする際の例外にガードを追加し、適切にログに記録されるようになしました。これによりヌルシェーダが使用され、ピンク色のエラーマテリアルでマテリアルが読み込まれない状態のままになることがないようになりました。
- `FireOnChange<T>` ノードの無効な上書き(overload)を無効なジェネリック引数で作成することができ、結果としてノード（および潜在的に他のもの）が壊れる原因となっていたのを修正（Psychpsyoさんの報告に基づいています）
- インベントリでアイテムを保存した際に、内部レコードキャッシュが特定のレコードを2つ重複して保存してしまう問題を修正
-- 削除後もUIにアイテムが表示されたままになるのを修正しました (chemicalcrux さん, H3BO3 さん, Toxic_Cookie さん, Hayden さん, Shifty さん, epicEaston197 さん, ProbablePrime さんにより報告されました)。
- ユーザーが使用できない移動方法がコンテキストメニューで灰色になっていた（グレーアウトされていた）のを修正。原因としては、特定のロコモーションモジュールが使用できるかどうかのチェックが正しくないためでした。(GearBell 氏による報告)