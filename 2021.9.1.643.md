**2021.9.1.643**
皆さん、こんにちは。BEPUv2の構造を使った最初の最適化の一つとして、ダイナミックボーンチェーンコリジョンシステムを再構築しました。このシステムでは、各チェーンが独自にコリジョンを見つけるのではなく、コリジョンのオーバーラップを効率的にクエリして伝達します。これにより、セッションに参加するユーザーの数が増えてもスケーリングしやすくなり、パフォーマンスも少し改善されるはずです。とはいえ、私はこの手法を少しずつ試しているところなので、この先もまだまだたくさんのことをやっていくつもりです。感想を聞かせてください。

他にも、BEPUv2アップグレードのためのバグフィックス（特に、点群が無意味なコリダーを生成して深刻なラグを引き起こす問題の修正）や、セキュリティの改善、生活の質の向上など、様々なことが行われています。

**新機能**:
- `DynamicSubtitleProvider` を追加しました。
-- これは、与えられたURLからNeosアニメーションとして字幕を動的にインポートします（Enverexさんのリクエスト、GitHub Issue #1260）。
-- サポートされるファイルは、静的にインポートされるものと同じです。HTTP(s)ソースをサポートしています。
- **`GetActiveUserSelf` LogiXノードを追加しました**(リクエスト: Shadow Panther [RU/EN, UTC+3], GitHub Issue #2790, implemented by ProbablePrime | Docs)
- RawDataTooltipだけでなく、任意のTooltipでEquippedとDequippedのイベントを取得できるようになりました(リクエスト: Turk and 3x1t_5tyl3, GitHub Issue #2026, implemented by ProbablePrime | Docs)
- Parsec for Distanceの単位解析とフォーマットのサポートを追加しました
**最適化**:
- **初期バージョンのセントラル・ダイナミック・ボーン・チェーン・アップデートとコリジョン・マネージメント・システムを実装しました。**
-- マネージャーはすべてのコリダーとダイナミックボーンを収集し、各ダイナミックボーンチェーンが独自のコリジョンを検索する代わりに、オーバーラップを効率的に検索するためにバウンディングボックスのツリー構造を非同期に更新します。
-- 暗黙的なプレーヤーのコリダーは、ダイナミックボーンごとに生成されるのではなく、グローバルに一度だけ生成されます。
-- これにより、ダイナミックボーンチェーンの一部が、セッション内のユーザー数の増加に応じてスケーリングされるようになり、パフォーマンスの一部が向上します。
-- **多くのユーザーがいるシナリオで何か違いに気づいたら、ぜひ教えてください。もっとプロファイリングをして、これがシステムの他の部分にどのような影響を与えるのかを把握する必要があります。**
-- メモリの割り当て量を減らす必要があります。
-- この変更による実際のシミュレーション性能への影響はありませんが、主に潜在的なコリダーを集める際のスケーリングの悪さを改善しています。
- より高価なチェックを行う前に、ダイナミックボーンコリジョンのより効率的なプルーニングを追加

**調整**:
- アップストリームから最新のBEPUv2アップデートを適用しました。
- インポートされた字幕オブジェクトに参照プロキシを追加し、インスペクタに直接ドロップできるようにしました。
- `UTCNow`ノードが`Math/DateTime`フォルダにも入るようになりました（Epsilion氏の要望、ProbablePrime氏の実装｜Docs)

**セキュリティ**:
- ユーザー空間でコンテキストメニューを開いたときに、ワールドからのレーザーのオフセットと方向が一時的に抑制されるようになりました（報告: by seif1, Ticket #622989の報告に基づく）。
-- これにより、ユーザーのレーザーをユーザー空間のアイテムに向けさせるために、インワールドでユーザーのレーザーをハイジャックするという攻撃を防ぐことができます。
-- アバターが切り替わらない限り、レーザーのオフセットは通常変更されないため、通常は機能的な違いはありません。
- `SimpleAvatarProtection` に、 "Remove Single Instance" ボタンを追加しました（報告: xYreous, Khosumi, Alex from Alaska, @kazu0617 , Electronus, Zyzyl, GitHub Issue #2897のフィードバックに基づく）。
- `SimpleAvatarProtection` に、専用ボタン以外の方法で削除すると自滅するという警告を追加しました（上記と同じ問題に基づく
- LogiX ビジュアルを生成する際に、生成中に削除されるとクラッシュするため、無限再帰に対する保護を追加しました(報告: marsmaantje, Ticket #790410)
- 追加するとワールドがクラッシュする原因となる古い DebugFingerPoseCompensation コンポーネントを削除しました (報告: dmx, Ticket #599312 and #910271)
**バグ修正**:
- 点群のための無意味なメッシュコライダーが生成されていた結果、これらのコライダーが掴めなくなり、クエリ時に極端なフリーズを起こすようになっていた問題を修正しました(恐らくBEPUv2に向けた対応とみています)。
- `IsCharacterOnGround`、`CharacterLinearVelocity`、`CharacterGravity`、`CharacterGroundCollider`が自分自身を更新するのではなく、`Updating Relay`を必要としていた問題の再発を修正(報告。報告者: Earthmark と Ho'polis, GitHub Issue #2896
- 一部の無効なメッシュが、ロード時、メタデータやアセットバリアントの生成時に例外を引き起こすのを修正しました。
- ジオメトリのないメッシュのコライダーを計算する際、わずかにメモリが破損する可能性があったのを修正
- `DynamicBoneChain`の`HandCollisionVibration`が動作しなかった問題を修正
- プロシージャルテクスチャとメッシュが何も参照されていない場合、ベイクに失敗することがあった問題を修正しました（Dante と Snooper による報告、GitHub Issue #2899 に基づく）。
- `CharacterController`が元々入っていたコンテンツをアップグレードする際(Tips: Neosはインベントリに入っているアイテムを生成時、保存時にバージョンが古いものを検知して現在のバージョンに合うように調整を行っています。その一環です。)、同じスロットにロコモーションモジュールが存在しない場合、`UseUserHeadHeightWhenAvailable`オプションが無効になるようになりました。
-- これにより、一部の古い乗り物が掴まれた時に壊れてしまうのを修正できます (報告: H3BO3, GitHub Issue #2898)

**2021.9.1.665**
新しいダイナミックボーンコリジョンハンドリングシステムに起因する小さなリグレッションのためのクイックホットフィックス。以前のビルドと互換性があります。

**バグ修正**:
- `DynamicBoneChain` のオプション、 `CollideWithOwnBody` にチェックされていないにもかかわらず自分の頭に衝突するように動作する問題を修正(報告: epicEaston197)